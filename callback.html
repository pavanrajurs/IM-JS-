<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Callback Functions</title>
</head>

<body>

  <script>
    // A callback is just a function you pass as an argument to another function, and it gets called later — either immediately or eventually (like after an async task).


    // STEP1: Create a normal function that does something
    function greet(name) {
      console.log(`Hello, ${name}!`);
    }

    // STEP2: Create a function that takes a callback
    function processUserInput(callback) {
      const name = "Raj";
      callback(name); // this is where the callback gets called
    }

    // STEP3:Pass the function as an argument (don’t call it)
    processUserInput(greet);
    // OUTPUT = Hello, Raj!

    //  Bonus: Anonymous Callback Example
    processUserInput(function (name) {
      console.log(`Hey there, ${name}, this is an anonymous callback!`);
    });

    // Or the cooler, cleaner way (with an arrow function):
    processUserInput((name) => {
      console.log(`Sup ${name}, arrow function reporting in.`);
    });

    // function sum(a, b) {
    //   console.log(a + b);

    // }
    // function calculator(a, b, sumCallback) {
    //   sumCallback(a, b);

    // }
    // calculator(12, 34, sum);

    //ex1
    function greet(name) {
      console.log(`Hello, ${name}!`);
    }

    function pu(callback) {
      let name = "pavan"
      callback(name);

    }
    pu(greet);
    // ex2
    function mainFunction(callback) {
      // ... do stuff
      callback(); // or pass something to it
    }

    // Option 1: Named function
    function myCallback() {
      console.log("Callback was called!");
    }
    mainFunction(myCallback);

    // function showThis() {
    //   console.log(this);
    // }

    // showThis();
    // examples
    function hello(callback) {
      console.log("hello");
      callback();
    }
    function wait() {
      console.log("wait");
    }
    function leave() {
      console.log("leave");
    }
    function goodbye() {
      console.log("goodbye");
    }
    hello(wait);

    // ex
    function sum(callback, x, y) {
      let result = x + y;
      callback(result);

    }

    function display(result) {
      console.log(`the sum of 2 numbers is ${result}`);
    }
    sum(display, 4, 5);

    // ex
    function doSomething(callback) {
      console.log("Doing something...");
      callback();
    }

    doSomething(function () {
      console.log("Callback executed!");
    });
    //ex

    function welcome(name) {
      console.log(`how are you ${name}`);
    }

    function getName(callback) {
      const name = "Pavan Raj"
      callback(name);
    }
    getName(welcome);

    //String transformation using callback
    function transformString(str, callback) {
      return callback(str);
    }

    console.log(transformString("hello", (s) => s.toUpperCase()));

    // Check number is even/odd via callback
    function checkNumber(num, callback) {
      callback(num % 2 === 0);
    }
    checkNumber(5, (isEven) =>
      console.log(isEven ? "Even" : "Odd")
    );


    // Callback to filter array
    function filterArray(arr, callback) {
      return arr.filter(callback);
    }

    console.log(filterArray([1, 2, 3, 4], (x) => x > 2));


    function sum(a, b) {
      return a + b;
    }
    function sub(a, b) {
      return a - b;
    }

    function div(a, b) {
      return a / b;
    }

    function calculotor(a, b, callback) {
      const result = callback(a, b);
      console.log("Result =", result)
    }

    calculotor(2, 3, sum);
    calculotor(2, 3, sub);
    calculotor(10, 5, div);

    // Simulate a form submission using settimeout
    function submitForm(data, onSuccess) {
      console.log("Form submitted:", data);
      onSuccess();
    }

    submitForm({ user: "Raj" }, () => console.log("Thanks for submitting!"));

    function submitForm(data, onSuccess, onError) {
      console.log("Submitting form...");
      setTimeout(() => {
        if (data.user) {
          console.log("Form submitted:", data);
          onSuccess();
        } else {
          onError("User data missing!");
        }
      }, 1000);
    }

    submitForm(
      { user: "Raj" },
      () => console.log("Thanks for submitting!"),
      (err) => console.error("Submission failed:", err)
    );

    //ex
    function greet(name, callback) {
      console.log("Processing...");

      setTimeout(() => {
        console.log("Hello, " + name);
        if (callback) {
          callback();
        };
      }, 1500);
    }

    greet("Raj", () => {
      console.log("Greeting complete ✅");
    });

    // //ex
    // function greet(name, callback) {
    //   console.log("Processing...");

    //   setTimeout(() => {
    //     console.log("Hello, " + name);
    //     if (typeof callback === "function") {
    //       callback();
    //     } else {
    //       console.error("❌ Callback is not a function!");
    //     }
    //   }, 200);
    // }

    //get one data after the other
    function getData(dataId, getNextData) {
      setTimeout(() => {
        console.log("data", dataId);
        if (getNextData) {
          getNextData();
        }
      }, 2000);
    }
    //callback hell => nested callbacks stacked below one another ,difficult to understand and manage
    getData(1, () => {
      console.log("getting data 2.....");
      getData(2, () => {
        console.log("getting data 3.....");
        getData(3, () => {
          console.log("getting data 4.....");
          getData(4);
        })
      })
    })

    //promises =>A Promise is an object that represents the eventual result (or failure) of an asynchronous operation.

    // it has three states(example of promise1)
    // Promise {<rejected>: 'some error occured'}
    // [[Prototype]] Promise
    // [[PromiseState]] "rejected"
    // [[PromiseResult]] "some error occured"

    //example
    // let promise = new Promise((resolve, reject) => {
    // //   console.log("i am a promise");
    // //   resolve(123)
    // // })

    let promise1 = new Promise((resolve, reject) => {
      console.log("i am a promise");
      reject("some error occured")
    })


    function c1() {
      console.log("hello  you");

    }
    function get(d, c) {
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          console.log(d);

          if (c) {
            c();
          }

          resolve("resolved");
        }, 6000);
      });
    }
    get(1, c1)

    const getPromise = () => {
      new Promise((resolve, reject) => {
        console.log("i am a promise");
        resolve("sucess");
      })
    }
    let promise = getPromise();
    promise.then(() => {
      console.log("promise fulfilled");
    });

  </script>
</body>

</html>